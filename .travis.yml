service:
- docker

language: java
jdk: oraclejdk8

addons:
  apt:
    update: true
    packages:
    - docker-ce
    - python-pip
    - curl
    - bash
    - jq

install: true
before_install:
- sudo pip install docker-compose httpie
- source <(curl -s https://raw.githubusercontent.com/daggerok/bash-functions/master/main.bash)
- stop_any 5432

script:
- export root=$PWD
# getting-started-jvm-vertx
- cd $root/getting-started-jvm-vertx
- ./gradlew clean build
# reactive-microservices-jvm-vertx
- cd $root/reactive-microservices-jvm-vertx
- ./gradlew clean build

before_cache:
- sudo rm -rf $HOME/.gradle/caches/*/fileHashes/fileHashes.bin
- sudo rm -rf $HOME/.gradle/caches/*/fileHashes/fileHashes.lock
- sudo rm -rf $HOME/.gradle/caches/modules-2/modules-2.lock

cache:
  directories:
  - $HOME/.m2/
  - $HOME/.gradle
